关于windows server 禁止ipv4  icmp协议
    Windows防火墙 --> 高级设置 --> 入站规则 --> 在列表里找到“文件和打印机共享(回显请求 - ICMPv4-In)” --> 右击选择启用规则，并在其属性里设置为‘允许连接'--> 确定
    只设置入站规则就可以了。
关于云平台上的地域和可用区的概念
    地域  region  指的是不同地理位置上数据中心，通常一个地域可以覆盖一片区域，如北京覆盖华北
    可用区 zone    在一个地域下，电力和网络下相互独立，软件故障隔离的物理数据中心。可用区开放的目的是允许用户自行选择资源的分配策略，以及提高业务的高可用。
    cvm 故障迁移时，只能在一个可用区之内进行切换，不可以在不同可用区迁移。

关于cvm镜像
    cvm 镜像和open stack的镜像概念相同，可以使用共有的镜像，自定义镜像等 。
    我们当然可以创建一个自定义镜像（我们可以基于公有的镜像在上面创建好所需的服务、环境之后创建自己的自定义镜像）来便于我们的操作。

    镜像复制 可以快速跨地域部署相同的cvm

    自定义镜像需要注意的：
                        1. 数据盘 mount 数据旁挂在请不要写到/etc/fstab 中，否则可能无法启动
                        2. 密码          密码使用镜像创建的cvm root用户密码是全新的，用户自己创建的额用户信息，将在新cmv中保留
                        3. 自动给启动服务  为了自动扩展能力而创建的镜像，应当设置好启动时需要自动启动的程序性
关于cvm的快照功能
    快照是在魔偶一个时间的拷贝，cmv快照存放在多个可用区以提高可用性

    用途 ：
        1. 数据在线实时备份
            数据备份，当应用程序或认为误删除数据时，可以通过快照恢复
        2. 关键里程碑的持久备份
            保留业务的历程状态
        3. 快速创建新硬盘
            通过数据盘快照可以恢复出与目前数据盘一样的新磁盘

扩容云硬盘
    注意在扩容云硬盘时需要先将硬盘卸载后进行操作
    https://cloud.tencent.com/document/product/362/6738#.E7.A1.AE.E8.AE.A4.E6.89.A9.E5.B1.95.E6.96.B9.E5.BC.8F
数据盘是不可以做镜像的，云盘不可以被不同可用区cvm使用，ssd和高性能云盘最大容量时16T
升级cvm的cpu和内存需要关机 带宽则不需要，垂直扩展不包括增加机器。
关于安全策略组
    入站规则
        限制源IP和目标端口
    出站规则
        限制目标IP和目标端口

    特点： CVM级别作用于每台CVM上，每台可以不一样
          有状态： 返回数据被自动运行
关于网络acl
    网络acl也叫网络访问控制列表
    特点：
        子网级别
        无状态：返回数据必须被规则允许才能通过。
        可选安全层
        作用于子网内所有云服务器，每台一样
        子网内CVM之间互访不影响
自动应用到子网内所有的云服务器，若CVM已经绑定安全组这里可以当作备份防御。
可以精确到协议和端口，由于无状态的特性，只设置入站规则，没有对应的出站规则会导致无法访问。
关于虚拟私有子网 VPC

    同一地域的不同可用区之间创建的虚拟子网是可以通信的。

关于绑定弹性公网IP

    这个操作类似于一对一的NAT地址转换，直通功能则是直接将IP绑定在网卡上 可以 ip a 查看到公网IP。
公网网关
        必须在购买CVM是勾选作为公网网关，才能实现。不能购买后修改，
    公网网关是开启了转发功能的云服务器。私有网络中没有外网IP的云服务器，可以通过 不同子网的公网网关访问互联网。
    公网网关将对公网流量进行源地址转换，其他云服务器的出口IP地址为网关的服务器IP地址。
    我们为公网网关配置的路由表只保留默认的路由表就好。
    我们需要配置策略将下一跳地址指向公网网关。
        也就是在配置普通子网的路由表时需要添加一条路由。
        目的端填写0.0.0.0/0 下一跳类型选择公网网关。
    注意 ： 公网网关只能转发非所在子网的路由转发请求， 所以公网网关和内网主机需要在不同子网。也就是同私有网络的不通子网。

    步骤1：创建网关子网。
    步骤2：购买公网网关。
    步骤3：创建网关子网路由表，网关所在的子网需单独一张路由表控制（在无其它路由诉求的情况，无需添加路由策略）。
    步骤4：配置普通子网路由表，新增路由策略：目的端为公网，下一跳指向公网网关。


NAT网关
    腾讯云提供了SNAT和DNAT能力
    SNAT （Source network address translation）源网络地址转换
        支持多个VPC云服务器通过同一公网IP主动访问互联网，支持单实例5Gbps转发能力
    DNAT (Destination network address translation)目的网络地址转换
        将VPC内的云服务器内网IP，协议端口，映射成外网IP，协议端口。使得云服务器上的服务可以被外网访问。

公网网关和NAT网关的区别
    可用性
        NAT网关双机热备份，自动切换
        公网网关 手动切
    带宽
        nat 最大5GBPS
        公网 取决于云服务器的带宽速度




关于快照和修改密码
    快照制作完成后，通过控制台修改的密码不受到快照的影响。
    快照完成后，服务器内修改密码，则密码和快照时密码保持一致。

VPC和子网的关系：
        参考官方文档 https://cloud.tencent.com/document/product/215/20046
        这是一个包含关系， VPC是由子网、网段、路由表组成的。
        注意: 私有网络是有地域属性的，子网有可用区域属性。
             一个私有网络中的子网默认是互通的。不管子网的可用区域是否一致。


如何建立对等连接

    参考官方文档  https://cloud.tencent.com/document/product/215/20082

    1.创建对等连接
        登录 腾讯云控制台 ，选择【云产品】>【网络】>【私有网络】，进入私有网络控制台。
        单击左侧目录中的【对等连接】，进入管理页面。
        在列表上方选择地域和私有网络，如广州和 VPC1，单击【+新建】，创建对等连接

        这一步请确认好本端VPC和对端VPC地址，创建后不支持修改只能只能删除重新创建。

        输入名称（如 PeerConn）、选择本端地域、本端网络，选择对端地域，如北京，对端账户类型及对端私有网络，同意服务协议。
        当对端账户类型为“我的账户”时，直接从下拉列表中选择。
        当对端账户类型为“其他账户”时，需要手动输入对端账户的账号 ID 和 VPC 的 ID

    2.在两端设置路由表

        登录 腾讯云控制台 ，选择【云产品】>【网络】>【私有网络】，进入私有网络控制台。
        单击左侧目录中的【子网】，进入管理页面。
        单击对等连接本端指定子网（子网 A）的关联路由表 ID（路由表 A），进入路由表的详情页。
        新建路由策略
            本端和对端都要做
            在目的端填入 对应子网的网段地址。 下一跳地址有对等连接担任。
                在建立对等连接时最重要的一步就是找到对方CVM所在的子网网段，并将这个网段作为目的地址，写入对应的路由表中。
                需要注意的是，不要将目的网段填错了，或者直接填入本地路由表。

        添加完路由表就可以ping通


配置双网卡 CVM
    参考官方文档
    https://cloud.tencent.com/document/product/576/18535
    1.控制面板 > 私有网络 > IP与网卡 > 弹性网卡
    2.进入后新建 注意这里要填的 所属网络和所属子网，一定要选择正确。
    3.购买完成后，找到刚才找到创建的网卡。 选择需要绑定CVM绑定。
      绑定完成后可以在终端中使用命令 ip a s 查看
    4.绑定完成后一般是没有IP地址的，需要我们手工创建网卡配置文件。
       DEVICE=lo:0                             //网卡配置文件的默认格式
       IPADDR=192.168.4.15
       NETMASK=255.255.255.255 //确保只有一个ip
       NETWORK=192.168.4.15
       BROADCAST=192.168.4.15
       ONBOOT=yes
       NAME=lo:0

    5.创建完成确认网卡配置文件没有问题后我们可以重启网络服务
        systemctl restart network

        这时外部主机还不能ping通，只是机器本机可以通信了。

        需要我们修改内核参数来完成通外网
        vim /etc/sysctl.conf
        把配置文件中原配置中的net.ipv4.conf.default.rp_filter = 1，修改成： 没有这一项就直接把下面的添加到配置文件。
        net.ipv4.conf.default.rp_filter = 0
        net.ipv4.conf.all.rp_filter = 0
        net.ipv4.conf.eth0.rp_filter = 0
        net.ipv4.conf.eth1.rp_filter = 0
            再次重启网络服务并重新加载内核参数配置文件。
        systemctl restart network && sysctl -p

        linux 到这一步就算完成了 windows 可以参考教程。


网络 acl
    配置 入站 端口目标端口 IP源IP   （从客户端向服务器的流量方向）
    配置 出站 端口目标端口 IP目标IP （从服务器向客户端的流量方向）

查询IP归属地

    curl myip.ipip.net

创建VPN网关连接
    优点 高可靠，安全加密
    参考文档
    https://cloud.tencent.com/document/product/215/20084
    VPN网关配置 腾讯云本地对腾讯云的vpn
    https://lexiangla.com/docs/aa946b1a64d211e9b875525400177fdc?lxref=search-company&company_from=385abcf0dd9d11e8a11752540005f435
    第一步 在本地子网创建 VPN网关
        登录 腾讯云控制台，选择【云产品】>【私有网络】进入私有网络控制台。
        在左侧目录中单击【VPN 连接】>【VPN 网关】，进入管理页。
        选择私有网络所在的地域和私有网络，如示例中的广州和TomVPC，单击【+新建】。
    第二步 创建对端网关
        在 VPN 通道创建前，需要创建对端网关：
        登录 腾讯云控制台，选择【云产品】>【私有网络】进入私有网络控制台。
        在左侧目录中单击【VPN 连接】>【对端网关】，进入管理页。
        选择地域，如示例中的广州，单击【+新建】。
        创建完成后就可以看到外网IP

        上面两部都要网关都要创建。
    第三步 创建VPN通道

            创建两个VPN通道，注意设置时。
            这里共享密钥现需要我们确认创建的两个VPN通道使用的密码必须一致。
            注意这里私有网络、VPN网关、对端网关和对端网关IP的选择和填写。这里对端网关IP请在VPN网关中查看。
            下一步则是，填写SPD限制哪个网段可以使用VPN。这里需要填写本端和远端的子网信息，需要我们在两台CVM所在子网中查询。
            创建SPD规则，其他配置可以默认。

    第四部 本地网关配置

           创建路由表两端 都要设置， 下一跳类型选VPN网关。确认配置无误 后 在一端ping 另一端的内网IP，若配置成功 就可以通了。


